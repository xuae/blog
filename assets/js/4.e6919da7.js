(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{501:function(t,s,e){t.exports=e.p+"assets/img/plugin.97248a86.png"},502:function(t,s,e){t.exports=e.p+"assets/img/plugin-nodejs.b9e3ba06.png"},503:function(t,s,e){t.exports=e.p+"assets/img/plugin-nodejs-install.2666315e.png"},504:function(t,s,e){t.exports=e.p+"assets/img/plugin-git-parameter.b44b1f95.png"},505:function(t,s,e){t.exports=e.p+"assets/img/plugin-build-generic-webhook-trigger.44bde016.png"},506:function(t,s,e){t.exports=e.p+"assets/img/plugin-bulid-name.a388918d.png"},507:function(t,s,e){t.exports=e.p+"assets/img/plugin-build-timestamp.fcdb7b5b.png"},508:function(t,s,e){t.exports=e.p+"assets/img/config.03a87084.png"},509:function(t,s,e){t.exports=e.p+"assets/img/config-nodejs.53003685.png"},510:function(t,s,e){t.exports=e.p+"assets/img/task.b3b505a6.png"},511:function(t,s,e){t.exports=e.p+"assets/img/task-name.d1de6abb.png"},512:function(t,s,e){t.exports=e.p+"assets/img/task-general-param.b1f22014.png"},513:function(t,s,e){t.exports=e.p+"assets/img/task-general-param-git.659fe443.png"},514:function(t,s,e){t.exports=e.p+"assets/img/task-general-param-env.1b4a8c48.png"},515:function(t,s,e){t.exports=e.p+"assets/img/task-origin-git.b7cf2e18.png"},516:function(t,s,e){t.exports=e.p+"assets/img/config-trigger-webhook.7b0e48fd.png"},517:function(t,s,e){t.exports=e.p+"assets/img/config-trigger-webhook-gitea.141c5db8.png"},518:function(t,s,e){t.exports=e.p+"assets/img/config-trigger-webhook-gitea-1.c3103728.png"},519:function(t,s,e){t.exports=e.p+"assets/img/config-trigger-webhook-2.e5bd7266.png"},520:function(t,s,e){t.exports=e.p+"assets/img/config-build.c770c9a5.png"},560:function(t,s,e){"use strict";e.r(s);var a=e(5),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("Boxx"),t._v(" "),a("h2",{attrs:{id:"安装插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装插件"}},[t._v("#")]),t._v(" 安装插件")]),t._v(" "),a("p",[t._v("若已安装，请忽略此步骤")]),t._v(" "),a("p",[t._v("进入 "),a("code",[t._v("Jenkins")]),t._v(" "),a("strong",[t._v("系统管理(Manage Jenkins)")]),t._v("，点击 "),a("strong",[t._v("插件管理(Manage Plugins)")]),t._v("，可对插件进行添加和卸载\n"),a("img",{attrs:{src:e(501),alt:"插件管理"}})]),t._v(" "),a("ul",[a("li",[a("p",[t._v("安装 NodeJS")]),t._v(" "),a("ol",[a("li",[t._v("输入 "),a("code",[t._v("nodejs")]),t._v("，选中 "),a("code",[t._v("NodeJS")]),t._v(" ，点击 "),a("strong",[t._v("Install without restart")]),t._v(" "),a("img",{attrs:{src:e(502),alt:"nodejs查看"}})]),t._v(" "),a("li",[t._v("等待安装完成即可\n"),a("img",{attrs:{src:e(503),alt:"nodejs安装中"}})])])]),t._v(" "),a("li",[a("p",[t._v("安装 Git Parameter（非必须）")]),t._v(" "),a("p",[t._v("配置 Git 参数，可用于获取仓库的分支/标签，进行自定义分支/标签构建")]),t._v(" "),a("p",[a("img",{attrs:{src:e(504),alt:"Git Parameter"}})])]),t._v(" "),a("li",[a("p",[t._v("安装 Generic Webhook Trigger（非必须）")]),t._v(" "),a("p",[t._v("通用的 Webhook 触发器，配置 Git Webhook 事件，当触发事件时，向 Jenkins 推送请求，可实现提交代码时构建项目的功能")]),t._v(" "),a("p",[a("img",{attrs:{src:e(505),alt:"Generic Webhook Trigger"}})])]),t._v(" "),a("li",[a("p",[t._v("安装 Build Name and Description Setter（非必须）\n"),a("img",{attrs:{src:e(506),alt:"Build Name"}})])]),t._v(" "),a("li",[a("p",[t._v("安装 Build Timestamp（非必须）\n"),a("img",{attrs:{src:e(507),alt:"Build Timestamp"}})])])]),t._v(" "),a("h2",{attrs:{id:"配置插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置插件"}},[t._v("#")]),t._v(" 配置插件")]),t._v(" "),a("p",[t._v("进入 "),a("code",[t._v("Jenkins")]),t._v(" "),a("strong",[t._v("系统管理(Manage Jenkins)")]),t._v("，点击 "),a("strong",[t._v("全局工具配置(Global Toll Configuration)")]),t._v(" "),a("img",{attrs:{src:e(508),alt:"全局工具配置"}})]),t._v(" "),a("ul",[a("li",[a("p",[t._v("配置 NodeJS")]),t._v(" "),a("p",[t._v("选择 "),a("strong",[t._v("新增 NodeJS")]),t._v("，配置好版本号以后，点击 "),a("strong",[t._v("保存")]),t._v(" 即可完成设置")]),t._v(" "),a("p",[a("img",{attrs:{src:e(509),alt:"nodejs配置"}})])])]),t._v(" "),a("h2",{attrs:{id:"新建任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新建任务"}},[t._v("#")]),t._v(" 新建任务")]),t._v(" "),a("ol",[a("li",[t._v("点击 "),a("strong",[t._v("新建任务")]),t._v(" "),a("img",{attrs:{src:e(510),alt:"新建任务"}})]),t._v(" "),a("li",[t._v("输入任务名称 "),a("code",[t._v("test")]),t._v("，选择 "),a("strong",[t._v("构建一个自由风格的软件项目")]),t._v("，点击 "),a("strong",[t._v("确定")]),t._v("（可从已有任务中复制创建）\n"),a("img",{attrs:{src:e(511),alt:"任务名称"}})])]),t._v(" "),a("h2",{attrs:{id:"添加构建参数（非必须）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加构建参数（非必须）"}},[t._v("#")]),t._v(" 添加构建参数（非必须）")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"title"}),a("p",[a("strong",[t._v("注意")]),t._v("：")]),t._v(" "),a("p",[t._v("若需要手动构建，可配置此参数")]),t._v(" "),a("p",[t._v("若使用 WebHook 触发器构建，则无需配置此项")])]),a("p",[t._v("勾选 "),a("strong",[t._v("参数化构建过程(This project is parameterized)")]),t._v("，在此定义一些参数，在执行shell脚本的时候，可以拿到这些参数来做一些额外的处理\n"),a("img",{attrs:{src:e(512),alt:"构建参数配置"}})]),t._v(" "),a("h3",{attrs:{id:"git-参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#git-参数"}},[t._v("#")]),t._v(" Git 参数")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"title"}),a("p",[a("strong",[t._v("注意")]),t._v("：必须安装了 "),a("code",[t._v("Git Parameter")]),t._v(" 插件，才能配置此项")])]),a("ol",[a("li",[t._v("点击 "),a("strong",[t._v("添加参数")])]),t._v(" "),a("li",[t._v("选择 "),a("strong",[t._v("Git 参数(Git Parameter)")])]),t._v(" "),a("li",[t._v("填写配置，表示 "),a("code",[t._v("Jenkins")]),t._v(" 来拉取代码的时候，拉取指定分支的代码，可以通过 "),a("code",[t._v("$branch")]),t._v(" 来访问变量\n"),a("ul",[a("li",[t._v("变量名称：branch")]),t._v(" "),a("li",[t._v("描述：分支(默认：origin/master)")]),t._v(" "),a("li",[t._v("参数类型：分支")]),t._v(" "),a("li",[t._v("默认值：origin/master\n"),a("img",{attrs:{src:e(513),alt:"Git 参数"}})])])])]),t._v(" "),a("h3",{attrs:{id:"env-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#env-配置"}},[t._v("#")]),t._v(" ENV 配置")]),t._v(" "),a("ol",[a("li",[t._v("点击 "),a("strong",[t._v("添加参数")])]),t._v(" "),a("li",[t._v("选择 "),a("strong",[t._v("选项参数")])]),t._v(" "),a("li",[t._v("配置前端项目所属的环境变量选项（选项：每行一个，第一行的将作为默认选项）：\n"),a("ul",[a("li",[a("code",[t._v("development")]),t._v(": 开发环境")]),t._v(" "),a("li",[a("code",[t._v("test")]),t._v(": 测试环境")]),t._v(" "),a("li",[a("code",[t._v("production")]),t._v(": 生产环境（正式）")])])])]),t._v(" "),a("p",[a("code",[t._v("ENV")]),t._v(" 在前端项目构建时，会当作变量传入，用于动态修改构建的项目环境类型\n"),a("img",{attrs:{src:e(514),alt:"ENV"}})]),t._v(" "),a("p",[t._v("构建前端资源时，会执行 "),a("code",[t._v("npm run build:${传入的环境参数}")]),t._v(" 命令。对应的为前端项目 package.json 中各环境的打包命令")]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build:development"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service build --mode=development"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build:test"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service build --mode=test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build:production"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-cli-service build --mode=production"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[t._v("此处利用了 "),a("code",[t._v("vue-cli3.0")]),t._v(" 提供的构建命令和环境变量文件，来提供各环境的打包命令。前端项目需要配置多种打包命令，来支持 "),a("code",[t._v("Jenkins")]),t._v(" 的动态环境构建")]),t._v(" "),a("h2",{attrs:{id:"源码管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#源码管理"}},[t._v("#")]),t._v(" 源码管理")]),t._v(" "),a("p",[a("img",{attrs:{src:e(515),alt:"源码管理 Git"}})]),t._v(" "),a("ol",[a("li",[t._v("在源码管理选择Git")]),t._v(" "),a("li",[t._v("选择项目代码存放的git地址，输入用户名和密码校验")]),t._v(" "),a("li",[t._v("Branches to build 选项根据需要可填写 "),a("code",[t._v("$branch")]),t._v(", 这个是上面 "),a("strong",[t._v("构建参数")]),t._v(" 内填写的 "),a("strong",[t._v("Git 参数")]),t._v(" 值，若未设置，可填写分支名称")])]),t._v(" "),a("h2",{attrs:{id:"构建触发器（非必须）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建触发器（非必须）"}},[t._v("#")]),t._v(" 构建触发器（非必须）")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"title"}),a("p",[a("strong",[t._v("注意")]),t._v(":")]),t._v(" "),a("p",[t._v("必须安装了 "),a("code",[t._v("Generic Webhook Trigger")]),t._v(" 插件，才有此配置选项")]),t._v(" "),a("p",[t._v("配置了构建触发器，则无需配置参数，否则会构建失败")])]),a("p",[a("img",{attrs:{src:e(516),alt:"Webhook Trigger"}})]),t._v(" "),a("ol",[a("li",[a("p",[t._v("在构建触发器中选择 Generic Webhook Trigger")])]),t._v(" "),a("li",[a("p",[t._v("在 "),a("code",[t._v("Token")]),t._v(" 栏输入自定义值")])]),t._v(" "),a("li",[a("p",[t._v("我使用的是 Gitea 服务器，所以需要在仓库-> "),a("strong",[t._v("设置")]),t._v(" -> "),a("strong",[t._v("Web 钩子")]),t._v(" 中配置 Url 和 触发条件")]),t._v(" "),a("p",[a("img",{attrs:{src:e(517),alt:"Gitea Webhook"}})]),t._v(" "),a("p",[t._v("目标 "),a("code",[t._v("URL")]),t._v(" 组成是：http://"),a("code",[t._v("Jenkins服务器域名或ip")]),t._v("/generic-webhook-trigger/invoke?token="),a("code",[t._v("Jenkins中配置的Token值")])]),t._v(" "),a("p",[t._v("触发条件根据需求选择，我这里选择的是推送事件，分支是 master，当推送代码至 master 分支时，将触发 Jenkins 构建")]),t._v(" "),a("p",[t._v("配置完成后勾选 "),a("strong",[t._v("激活")]),t._v(" 并 "),a("strong",[t._v("添加 Web 钩子")])])]),t._v(" "),a("li",[a("p",[t._v("在 Web 钩子列表中点击刚才配置的钩子，点击下面的 "),a("strong",[t._v("测试推送")]),t._v("，可测试推送到 Jenkins")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"title"}),a("p",[a("strong",[t._v("注意")]),t._v("：记得完成 "),a("strong",[t._v("构建")]),t._v(" 步骤 Shell 命令的填写")])]),a("p",[a("img",{attrs:{src:e(518),alt:"Gitea Webhook Test"}})])]),t._v(" "),a("li",[a("p",[t._v("登录 Jenkins，查看此项目已构建成功\n"),a("img",{attrs:{src:e(519),alt:"Webhook Trigger Build"}})])])]),t._v(" "),a("h2",{attrs:{id:"构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建"}},[t._v("#")]),t._v(" 构建")]),t._v(" "),a("p",[a("img",{attrs:{src:e(520),alt:"Build"}})]),t._v(" "),a("ol",[a("li",[t._v("增加构建步骤，选择 "),a("strong",[t._v("执行 Shell")])]),t._v(" "),a("li",[t._v("根据项目执行步骤添加 "),a("strong",[t._v("命令")]),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 若配置了 ENV 环境变量，可将 build 改为")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ENV}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])])])])],1)}),[],!1,null,null,null);s.default=n.exports}}]);